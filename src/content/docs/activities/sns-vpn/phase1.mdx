---
title: "Phase 1 : Configuration de base et accÃ¨s Ã  l'interface web"
draft: true
---

## Phase 1 : Configuration de base et accÃ¨s Ã  l'interface web

### DurÃ©e estimÃ©e : 1h00

### Objectifs de cette phase

- âœ… Se connecter Ã  l'interface web d'administration du SNS
- âœ… DÃ©couvrir l'interface graphique Stormshield
- âœ… Configurer les paramÃ¨tres systÃ¨me de base
- âœ… CrÃ©er les premiÃ¨res rÃ¨gles de filtrage
- âœ… Configurer le NAT pour l'accÃ¨s Internet depuis le rÃ©seau interne

---

### Ã‰tape 1.1 : PremiÃ¨re connexion Ã  l'interface web (Ã‰tudiant Y)

:::caution[RÃ´le spÃ©cifique]
**Cette phase est principalement rÃ©alisÃ©e par l'Ã‰tudiant Y** (Serveur VPN).
L'Ã‰tudiant X peut observer ou rÃ©aliser les mÃªmes manipulations sur son propre SNS pour s'entraÃ®ner.
:::

#### ğŸ”§ TÃ¢che : Se connecter Ã  l'interface d'administration

**1. Ouvrir un navigateur web**

Depuis votre **machine hÃ´te** ou depuis la **VM Client VPN** :

```
URL : https://172.25.Y.254/admin
```
(Remplacer Y par votre numÃ©ro)

**2. Accepter le certificat auto-signÃ©**

Le navigateur va afficher un avertissement de sÃ©curitÃ© (certificat SSL non reconnu) :
- Cliquer sur `AvancÃ©` ou `ParamÃ¨tres avancÃ©s`
- Cliquer sur `Accepter le risque et continuer` ou `Continuer vers le site`

:::tip[Pourquoi cette alerte ?]
Le SNS utilise un certificat SSL auto-signÃ© (non validÃ© par une autoritÃ© de certification).
C'est normal pour un environnement de test. En production, on utiliserait un vrai certificat.
:::

**3. Se connecter**

Page de login du SNS :
- **Nom d'utilisateur** : `admin`
- **Mot de passe** : `admin`
- Cliquer sur `Connexion`

---

### Ã‰tape 1.2 : Configuration systÃ¨me de base

#### ğŸ”§ TÃ¢che : DÃ©finir les paramÃ¨tres gÃ©nÃ©raux du firewall

**1. AccÃ©der Ã  la configuration systÃ¨me**

Dans le menu de gauche :
```
Configuration â†’ SystÃ¨me â†’ Configuration
```

**2. Configurer les paramÃ¨tres gÃ©nÃ©raux**

Onglet **GÃ©nÃ©ral** :
- **Nom du firewall** : `SNS-Serveur-Y` (remplacer Y)
- **Fuseau horaire** : `Europe/Paris`
- **Serveurs NTP** :
- Laisser les autres paramÃ¨tres par dÃ©faut

**3. Enregistrer**

Cliquer sur `Appliquer` en bas de la page.

#### ğŸ”§ TÃ¢che : VÃ©rifier la configuration rÃ©seau

**1. AccÃ©der aux interfaces rÃ©seau**

```
Configuration â†’ RÃ©seau â†’ Interfaces
```

**2. VÃ©rifier les interfaces**

Vous devez voir :

| Interface | Nom | Adresse IP      | Ã‰tat          |
| --------- | --- | --------------- | ------------- |
| **out**   | out | 172.25.Y.254/16 | UP (connectÃ©) |
| **in**    | in  | 10.Y.1.254/24   | UP (connectÃ©) |

**3. Configurer les rÃ´les des interfaces (si pas dÃ©jÃ  fait)**

Cliquer sur l'interface **out** :
- **Protection** : âœ… Activer le filtrage
- **Type de zone** : `Internet` (rouge)
- **Appliquer**

Cliquer sur l'interface **in** :
- **Protection** : âœ… Activer le filtrage
- **Type de zone** : `RÃ©seau interne` (vert)
- **Appliquer**

:::tip[Zones de sÃ©curitÃ©]
Les couleurs reprÃ©sentent les niveaux de confiance :
- ğŸ”´ **Rouge (Internet/out)** : Zone non fiable, accÃ¨s depuis l'extÃ©rieur
- ğŸŸ¢ **Vert (Interne/in)** : Zone de confiance, rÃ©seau d'entreprise
- ğŸŸ  **Orange (DMZ)** : Zone intermÃ©diaire (serveurs publics)
:::

**4. VÃ©rifier les routes**

```
Configuration â†’ RÃ©seau â†’ Routage â†’ Routes
```

VÃ©rifier la prÃ©sence de la route par dÃ©faut :
- **Destination** : `0.0.0.0/0` (route par dÃ©faut)
- **Passerelle** : `172.25.254.254`
- **Interface** : `out`

:::tip[Validation Ã‰tape 1.2]
âœ… Capture d'Ã©cran Ã  inclure :
- Page des interfaces rÃ©seau montrant les deux interfaces UP
- Page des routes montrant la route par dÃ©faut
:::

---

### Ã‰tape 1.3 : Configuration des rÃ¨gles de filtrage de base

#### ğŸ¯ Objectif
CrÃ©er les rÃ¨gles nÃ©cessaires pour :
1. Autoriser le SNS Ã  accÃ©der Ã  Internet (mises Ã  jour, NTP)
2. Autoriser le serveur Debian Ã  accÃ©der Ã  Internet
3. Bloquer tout le reste par dÃ©faut

#### ğŸ”§ TÃ¢che : AccÃ©der au module de filtrage

```
Configuration â†’ Politique de sÃ©curitÃ© â†’ Filtrage et NAT â†’ RÃ¨gles de filtrage
```

Vous voyez la liste des rÃ¨gles par dÃ©faut (gÃ©nÃ©ralement vide ou avec quelques rÃ¨gles de base).

#### ğŸ”§ TÃ¢che : CrÃ©er la rÃ¨gle 1 - Autoriser le firewall vers Internet

**1. Cliquer sur `Ajouter` (en haut)**

**2. ParamÃ¨tres de la rÃ¨gle :**

- **Nom de la rÃ¨gle** : `Firewall vers Internet`
- **Ã‰tat** : âœ… ActivÃ©
- **Action** : `Accepter` (couleur verte)

**Onglet Origine :**
- **Source** : Cliquer sur `+`
  - Type : `Objet de type Firewall`
  - SÃ©lectionner : `Firewall_out` (interface OUT du firewall)
  - Valider

**Onglet Destination :**
- **Destination** : Cliquer sur `+`
  - Type : `RÃ©seau`
  - SÃ©lectionner : `Internet` (objet prÃ©dÃ©fini)
  - Valider

**Onglet Service :**
- **Service** : Laisser `any` (tous les services)

**Onglet Options :**
- Inspection : `DÃ©sactivÃ©e` (pour l'instant)
- Logs : âœ… `Activer les logs` (pour dÃ©boguer)

**3. Cliquer sur `CrÃ©er`**

:::tip[Explication]
Cette rÃ¨gle permet au firewall lui-mÃªme (son interface OUT) de sortir vers Internet.
C'est nÃ©cessaire pour :
- Synchronisation NTP (heure)
- TÃ©lÃ©chargement des mises Ã  jour
- RÃ©solution DNS
:::

#### ğŸ”§ TÃ¢che : CrÃ©er la rÃ¨gle 2 - Autoriser le rÃ©seau interne vers Internet

**1. Cliquer sur `Ajouter`**

**2. ParamÃ¨tres :**

- **Nom** : `RÃ©seau interne vers Internet`
- **Ã‰tat** : âœ… ActivÃ©
- **Action** : `Accepter`

**Origine :**
- Source : `Network_internals` (ou crÃ©er un objet rÃ©seau `10.Y.1.0/24`)
  - Si l'objet n'existe pas : `Configuration â†’ Objets â†’ RÃ©seaux` â†’ `Ajouter`
  - Nom : `Reseau_Interne_Y`
  - Type : `RÃ©seau`
  - Adresse : `10.Y.1.0/24`
  - Sauvegarder et retourner aux rÃ¨gles

**Destination :**
- Destination : `Internet`

**Service :**
- Service : `any`

**Options :**
- Logs : âœ… ActivÃ©s

**3. CrÃ©er**

#### ğŸ”§ TÃ¢che : VÃ©rifier l'ordre des rÃ¨gles

**Important** : Les rÃ¨gles de filtrage sont Ã©valuÃ©es **de haut en bas**.
La premiÃ¨re rÃ¨gle correspondante est appliquÃ©e.

Ordre recommandÃ© :
```
1. Firewall vers Internet          [ACCEPT]
2. RÃ©seau interne vers Internet    [ACCEPT]
3. [Implicite] Deny All            [BLOCK]
```

Si l'ordre n'est pas bon, utilisez les flÃ¨ches â¬†ï¸ â¬‡ï¸ pour rÃ©organiser.

:::caution[RÃ¨gle implicite]
Par dÃ©faut, Stormshield a une rÃ¨gle implicite en fin de liste : **TOUT BLOQUER**.
Donc si aucune rÃ¨gle ne correspond, le trafic est bloquÃ©.
C'est une bonne pratique de sÃ©curitÃ© : "Ce qui n'est pas explicitement autorisÃ© est interdit".
:::

:::tip[Validation Ã‰tape 1.3]
âœ… Capture d'Ã©cran Ã  inclure :
- Liste des rÃ¨gles de filtrage crÃ©Ã©es
âœ… Commandes de test depuis le serveur Debian :
```bash
ping 8.8.8.8          # Doit Ã©chouer (NAT pas encore configurÃ©)
```
:::

---

### Ã‰tape 1.4 : Configuration du NAT (Network Address Translation)

#### ğŸ¯ Objectif
Le serveur Debian (10.Y.1.20) a une IP privÃ©e. Pour qu'il puisse accÃ©der Ã  Internet, il faut configurer le NAT sur le firewall pour traduire son adresse privÃ©e en l'adresse publique du SNS (172.25.Y.254).

#### ğŸ”§ TÃ¢che : CrÃ©er une rÃ¨gle de NAT dynamique

**1. AccÃ©der au NAT**

```
Configuration â†’ Politique de sÃ©curitÃ© â†’ Filtrage et NAT â†’ NAT
```

**2. CrÃ©er une rÃ¨gle de NAT**

Cliquer sur `Ajouter` :

- **Nom** : `NAT RÃ©seau interne vers Internet`
- **Ã‰tat** : âœ… ActivÃ©

**Onglet Original :**
- **Source** : `Network_internals` ou `Reseau_Interne_Y` (10.Y.1.0/24)
- **Destination** : `Internet`
- **Service** : `any`

**Onglet TranslatÃ© :**
- **Source** :
  - Type : `Objet Firewall`
  - SÃ©lectionner : `Firewall_out` (l'interface OUT du SNS - 172.25.Y.254)
- **Destination** : `Original destination` (ne pas modifier)
- **Service** : `Original service`

**Type de NAT :** `Dynamique` (PAT - Port Address Translation)

**3. CrÃ©er et appliquer**

:::tip[Principe du NAT]
Le NAT va transformer :
- Paquet sortant du serveur : `SRC: 10.Y.1.20 â†’ DST: 8.8.8.8`
- En : `SRC: 172.25.Y.254:random_port â†’ DST: 8.8.8.8`

Le firewall garde une table de correspondance pour retransmettre les rÃ©ponses au bon serveur.
:::

---

### Ã‰tape 1.5 : Validation de la configuration rÃ©seau

#### âœ… Tests Ã  effectuer depuis le serveur Debian (Ã‰tudiant Y)

Se connecter en SSH au serveur Debian (depuis votre VM Client ou machine hÃ´te) :

```bash
ssh techservices@10.Y.1.20
# Mot de passe : Sio2025!
```

**Test 1 - ConnectivitÃ© Internet :**
```bash
ping -c 4 8.8.8.8
```
**RÃ©sultat attendu :** âœ… RÃ©ponses OK

**Test 2 - RÃ©solution DNS :**
```bash
ping -c 4 www.google.com
```
**RÃ©sultat attendu :** âœ… RÃ©ponses OK (preuve que le DNS fonctionne)

**Test 3 - AccÃ¨s HTTP :**
```bash
curl -I https://www.google.com
```
**RÃ©sultat attendu :** âœ… HTTP 200 OK ou 301/302 redirect

**Test 4 - Mise Ã  jour des paquets :**
```bash
sudo apt update
```
**RÃ©sultat attendu :** âœ… Liste des paquets disponibles

#### âœ… Tests depuis la VM Client VPN (Ã‰tudiant X)

**Test 1 - AccÃ¨s au SNS Serveur :**
```bash
ping -c 4 172.25.Y.254
```
**RÃ©sultat attendu :** âœ… RÃ©ponses OK

**Test 2 - Tentative d'accÃ¨s au serveur Debian :**
```bash
ping -c 4 10.Y.1.20
```
**RÃ©sultat attendu :** âŒ Pas de rÃ©ponse (NORMAL - c'est ce que le VPN va rÃ©soudre !)

**Test 3 - Tentative d'accÃ¨s web au serveur :**
```bash
curl http://10.Y.1.20
```
**RÃ©sultat attendu :** âŒ Timeout ou pas de route (NORMAL)

---

### Ã‰tape 1.6 : Consultation des logs

#### ğŸ”§ TÃ¢che : VÃ©rifier que les rÃ¨gles fonctionnent

**1. AccÃ©der aux logs de filtrage**

```
Monitoring â†’ Logs â†’ Filtrage et NAT â†’ Connexions
```

**2. Observer les logs en temps rÃ©el**

Pendant que vous effectuez les tests ci-dessus, observez :
- Les lignes vertes (ACCEPT) correspondant aux rÃ¨gles autorisÃ©es
- L'absence de lignes rouges (BLOCK) pour le trafic autorisÃ©

**3. Filtrer les logs**

Utilisez les filtres pour voir uniquement :
- Source : `10.Y.1.20` (votre serveur Debian)
- Action : `PASS` (acceptÃ©)

Vous devriez voir les connexions sortantes du serveur vers Internet.

:::tip[Validation Ã‰tape 1.6]
âœ… Capture d'Ã©cran Ã  inclure :
- Logs montrant une connexion autorisÃ©e depuis 10.Y.1.20 vers Internet
- Avec la rÃ¨gle appliquÃ©e visible dans la colonne "RÃ¨gle"
:::

---

### âœ… Tableau de validation de la Phase 1

ComplÃ©tez ce tableau dans votre compte-rendu :

| Test                           | Commande                           | RÃ©sultat attendu         | âœ…/âŒ |
| ------------------------------ | ---------------------------------- | ------------------------ | ----- |
| Connexion interface web SNS    | `https://172.25.Y.254/admin`       | Page de login accessible |       |
| SNS vers Internet              | Depuis SNS console: `ping 8.8.8.8` | OK                       |       |
| Serveur Debian vers gateway    | `ping 10.Y.1.254`                  | OK                       |       |
| Serveur Debian vers Internet   | `ping 8.8.8.8`                     | OK                       |       |
| Serveur Debian rÃ©solution DNS  | `ping www.google.com`              | OK                       |       |
| Client VPN vers SNS OUT        | `ping 172.25.Y.254`                | OK                       |       |
| Client VPN vers Serveur Debian | `ping 10.Y.1.20`                   | âŒ Ã‰CHEC (normal)        |       |
| Logs de filtrage visibles      | Interface web SNS                  | Logs affichÃ©s            |       |

---

### âœ… CritÃ¨res de validation de la Phase 1

Avant de passer Ã  la Phase 2, assurez-vous que :

- [ ] Vous pouvez vous connecter Ã  l'interface web du SNS Serveur
- [ ] Les deux interfaces rÃ©seau (out et in) sont UP
- [ ] Le serveur Debian peut pinguer Internet (8.8.8.8)
- [ ] Le serveur Debian peut rÃ©soudre des noms de domaine
- [ ] Les rÃ¨gles de filtrage sont crÃ©Ã©es et fonctionnelles
- [ ] Le NAT est configurÃ© et opÃ©rationnel
- [ ] Vous voyez les logs de connexions dans l'interface
- [ ] Le Client VPN **ne peut toujours PAS** accÃ©der au serveur Debian (c'est normal !)

:::tip[Checkpoint enseignant]
ğŸ‘¨â€ğŸ« Avant de continuer, faites valider votre configuration par l'enseignant.
Montrez-lui :
1. L'interface web du SNS
2. Les rÃ¨gles de filtrage crÃ©Ã©es
3. Un ping rÃ©ussi depuis le serveur Debian vers Internet
4. Un ping Ã©chouÃ© depuis le Client VPN vers le serveur Debian
:::

---

## ğŸ¯ RÃ©sumÃ© de la Phase 1

Vous avez maintenant :

- âœ… Un firewall Stormshield accessible via interface web
- âœ… Des rÃ¨gles de filtrage de base configurÃ©es
- âœ… Un NAT fonctionnel pour le rÃ©seau interne
- âœ… Un serveur Debian qui peut accÃ©der Ã  Internet
- âœ… Un client VPN qui ne peut toujours pas accÃ©der aux ressources internes (problÃ¨me Ã  rÃ©soudre avec le VPN !)

**Prochaine Ã©tape** : Phase 2 - Configuration de l'annuaire LDAP interne et crÃ©ation des utilisateurs pour l'authentification VPN

---

